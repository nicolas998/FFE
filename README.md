This project contains the code and data for the work titled:

**Effect of Streamflow Measurement Error on Flood Frequency Estimation**

When measuring streamflow during high flows and flood events significant errors often arise. Such errors conflated by short records of observations may induce bias in the flood frequency estimations leading to costly engineering design mistakes.  This work explores how the observational (measurement) errors and the sample size affect the uncertainty of flood frequency estimation.  The study used the Bulletin 17C (U.S. standard) method to estimate flood frequencies of historical peak flows modified to represent the measurement and sampling limitations. To perform the modifications, the authors explored, via Monte Carlo simulation, three hypothetical scenarios that mimic measurement errors, sampling limitations, and their combination.  They used a multiplicative noise from a log-normal distribution to simulate the measurement errors.  They implemented a bootstrap approach to represent the sampling error, randomly selecting M samples from the total N records of the observed peak flows of four gauging stations in the state of Iowa  in central USA.  The observed data record is between 60 and 119 years for watersheds with areas ranging between 517 and 16,000 km2.  According to our results, the sample size and the measurement errors lead to significant differences among the realizations.  The three scenarios exhibited differences with median magnitudes of up to 30%. However, the combined case reached differences of around 100% for exceedance probabilities of 1%.  The results raise a red flag regarding flood frequency estimation that warrants looking for novel approaches, such as using hydrological models to generate longer records that allow us to overcome the data limitations.

The folders contain the following information:
- data: contains the `.PRT` files generated by **PeakFQ** for the analyzed watersheds. 
    - data/sim: Has the results from **PeakFQ** after running 1,000 cases for each river and case. The cases have the following conventions:
        - Error Dependent (ED): The error standard deviation changes with the magnitude of the peak flow  
        - Error Independent (EI): The standard deviation is constant
        - Sampling (S): Following a uniform rnadom function we selected a certain number of peaks.
        - Sampling and Error Independent (SEI): A combination between S and EI.
    - data/processed: Holds the relative error of the FFE for different cases in `numpy.savez` format. The *_YY* stands for the number of total years in the run and the *_c5* or *_c95* for the errors at the confidence intervals. 

- figures: Contains the figures of the resulting work.

Most of the analysis is done on the `mag_dependency_figures.ipynb` notebook. The analysis comparing all the cases vs all the cases is done at the `comparea_all_vs_all.py` script. The `peak_analist.py` contains a collection of functions to write peak files compatible with **PeakFQ** and to analyze its outputs.  
    